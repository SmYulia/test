Как обмениваться данными со статистиками 
===========

Это руководство для каждого, кому необходимо обмениваться данными со статистиками. 
Целевую аудиторию данного документа я предполагаю следующую:

* Научные сотрудники, которым нужны статистики для анализа данных
* Студенты и постодоки в научных дисциплинах, которые ищут квалифицированный совет 
* Студенты, только начинающие работать со статистикой, чей работой является сборка и очистка наборов данных

Цель этого руководства предоставить некоторую инструкцию по лучшему способу обмениваться данными, чтобы избежать наиболее 
распространенных ошибок и различных задержек при переходе от сбора данных к анализу данных. [Leek group](http://biostat.jhsph.edu/~jleek/) 
работает с большим количеством научных сотрудников и одним источником данных для скорости, и в результате получаем измененное состояние данных, когда они поступают в Leek group.
Основываясь на моих беседах с другими статистиками, это верно практически повсеместно.

Мое твердое мнение, что статистики должны обрабатывать данные в каком бы состоянии эти данные не были получены. Важно увидеть сырые данные, понять шаги, 
которые были выполнены при обработке и иметь возможность включить скрытые источники данных в этот анализ данных.
С другой стороны, для многих типов данных шаги обработки хорошо задокументированы и стандартизированы.Таким образом работа по переводу данных из 
сырой формы в непосредственно в анализируемую форму может быть выполнена до вызова статистика. Это может значительно ускроить сроки выполнения работ, поскольку 
статистик не должен участвовать в предварительной обработке данных.


Что вы должны донести до статистика
====================

Для максимальной скорости анализа данных, вы должны предоставить статиску следующую информацию:

1. Сырые данные.
2. Набор обработанных данных [Описание обработанных данных](http://vita.had.co.nz/papers/tidy-data.pdf) 
3. Справочник, описывающий каждую переменную и ее значения в наборе обработанных данных
4. Наличие четкой инструкции, рассказывающей о том как вы перешли от 1 -> 2,3 

Давайте рассмотрим каждую часть пакета данных, которую вы будете передавать.


### Сырые данные

Очень важно, что вы включаете самые сырые/необработанные данные, к которым у вас есть доступ. Это некоторые примеры сырой формы данных:

* Ваши измерения в виде [бинарного файла](http://en.wikipedia.org/wiki/Binary_file), который выдает машина
* Неотформатированный файл Excel с 10 вкладками-листами, который вам направила компания с которой у вас есть договор
* Сложные данные в формате [JSON](http://en.wikipedia.org/wiki/JSON)Ю которые вы получили через [Twitter API](https://twitter.com/twitterapi)
* Введенные вручную цифры, которые вы собрали наблюдая через микроскоп.

Вы знаете, что сырые данные находяться в правильном формате, если вы:

1. Не запускали программного обеспечения на этих данных
1. Не манипулировали любыми числами в этих данных
1. Не удаляли какие-либо данные из рассматриваемого набора данных
1. Вы не обобщали данные каким-либо способом

Если вы манипулировали данными в наборе, то это уже будут не сырые данные
If you did any manipulation of the data at all it is not the raw form of the data. Манипулирование сырыми данными очень распространный способ 
замедлить процесс анализа, так как аналитик будет часто проводить пристальное изучение данных, чтобы выяснить почему они выглядят странно.

### The Набор обработанных данных

Общие принципы обработанных данных изложены [Hadley Wickham](http://had.co.nz/) в [его работе](http://vita.had.co.nz/papers/tidy-data.pdf)
и [этом видео](http://vimeo.com/33727555). И работа и видео сфокусированы на [R](http://www.r-project.org/) пакете, который вы можете знать, 
а можете не знать как использовать. Несмотря на это, есть четыре принципа, на которые стоит обратить внимание:

1. Каждая переменная, которую вы измеряете, должна быть в отдельной колонке
1. Каждое наблюдение должно быть в отдельной строке
1. Должна быть одна таблица на каждый вид переменной
1. Если у вас несколько таблиц, то они должны содержать дополнительную колонку, которая позволит им быть связанными между собой

Кроме этих жестких правил есть ряд других вещей, которые позволят обрабатывать ваши данные гораздо проще.
Во-первых, необходимо включить строку на верх каждой таблицы с данными/листа, которая будет содержать полные имена колонок.
Так что если вы измерили возраст на момент постановки диагноза у пациентов, вы бы знали, что колонка с именем `AgeAtDiagnosis` вместо чего-то вроде `ADx` 
или другой аббревиатуры, которая может быть трудна для понимания для другого человека. 

Это пример того, как это бы работало в геномике. Предположим, что для 20 человек вы собрали измерения экспрессии генов в [РНК-последовательности]
(http://en.wikipedia.org/wiki/RNA-Seq). Вы также собрали демографические и клинические данные о пациентах, включая их возраст, лечение и диагнозы. 
У вас бы получилась одна таблица/лист, который содержал бы клиническую/демографическую информацию. Она имела бы 4 колонки (ИД пациента, возраст, лечение, диагнозы) 
и 21 строку (строка с именами переменных и одна строка для каждого пациента). У вас также был бы один лист для обобщения данных генома.
Обычно этот тип данных обощается на уровне числа импульсов в экзоне. Предположим, у вас есть 100,000 екзонов, то вы бы имели таблицу/лист, в котором бы 
была 21 строка (строка для имен геномов, и одна строка для каждого пациента) и 100,001 колонки (одна колонка для ids пациента и одна колонка для каждого типа данных)
  
Если вы обмениваетесь данными с коллегой в формате Excel, обработанные данные должны быть в одной таблице в одном Excel-файле. Они
 не должны быть на нескольких листах, к ним не должны быть применены макросы, а колонки/ячейки недолжны быть выделены.
Альтернативный способ обмениваться данными в [CSV](http://en.wikipedia.org/wiki/Comma-separated_values) или 
[TAB-delimited](http://en.wikipedia.org/wiki/Tab-separated_values) файле.


### Справочник

Почти для любого набора данных действия, которые вы выполнили, над этим набором должны быть описаны более подробно, чем у вас
в листе. Справочник содержит данную информацию. Как минум он должен содержать:

1. Инфорация о переменных (включая единицы измерения) в наборах данных, не вошедших в обработанные данные 
1. Информация о выполенных допущениях
1. Информация о структуре экспериментального исследования, которую вы использовали

В нашем геномном примере аналитик может захотеть узнать, какие единицы измерения для каждой 
клинической/демографической переменной использовались (возраст в годах, лечение по наименованию препарата/доза, уровень диагностики).
Также он захочет узнать, как вы отобрали экзонов, которых вы использовали для обобщения данных генома (UCSC/Ensembl, etc.). Он также 
захочет узнать любую другую информацию о том, как вы сделали сбор данных/структуру исследования. Например, эти первые 20 пациентов, 
которые гуляли в клинике? Или это 20 тщательно отобранных пациентов на основании какой-либо характеристики, например, возраст? Они 
рандомизированы для лечения?

Общий формат для такого документа это word файл. В документе должна быть секция "Структура исследования", в котором необходимо 
описать, как были собраны данные. Также в документе должнабыть секция "Справочник", в которой необходимо описать каждую переменную 
и ее единицы измерения. 

### Как обозначить значения переменных

Когда вы помещаете переменные в таблицу, существует несколько основных категорий, с которыми придется столкнуться в зависимости от их 
[типов данных](http://en.wikipedia.org/wiki/Statistical_data_type):

1. Непрерывные данные
1. Порядковые данные
1. Данные категрий
1. Отсутствующие даные 
1. Цензурные данные

Непрерывные переменные это что-либо, измеряемое по количественной шкале, и являющееся любым дробным числом. Например вес измеряется в килограммах. 
[Порядковые данные](http://en.wikipedia.org/wiki/Ordinal_data) это данные, которые фиксированы и имеют малое (<100) количество вариантов значений, но упорядоченных. 
Для примера это могут быть ответы на опрос, где возможны следующие варианты: плохое, удовлетворительное, хорошее. [Данные категорий](http://en.wikipedia.org/wiki/Categorical_variable) 
это данные, которые имеют несколько категорий, но они не упорядочены. Например, пол: мужской или женский. [Отсутствующие данные](http://en.wikipedia.org/wiki/Missing_data) это данные, 
которые отсутствуют и вы не знаете механизм. Вы должны обозначать такие данные как `NA`. [Цензурные данные](http://en.wikipedia.org/wiki/Censoring_(statistics\)) это данные, 
в которых вы знаете механизм пропажи даных на определенном уровне. Типичными примерами являются измерения, которые ниже предела обнаружения 
или пациент теряет их в дальнейшем. Они также обозначаются как `NA`, когда у вас отсутсвуют эти данные. Но вы также должны добавить новую колонку к вашим обработанным данным 
и назвать ее "VariableNameCensored", в которой отметить значения как `TRUE`, если они были зацензурены 
и `FALSE`, если нет. В справочнике вам необходимо объяснить почему эти значения отсутствуют. Это асолютно необходимо сообщить аналитику, если вы знаете причину, почему некоторые 
данные отсутствуют. 

В общем, старайтесь избегать обозначений порядковых данных и данных категории как чисел. Когда вы вводите значение для пола в обработанные данные, 
это должно быть "мужчина" или "женщина". Порядковые значения в наборе данных должны быть "плохое", "удовлетворительное", and "хорошее", а не 1, 2 ,3.
Это позволит избежать вероятной путаницы в дальнейших действиях и поможет выявить ошибки кодирования. 

Всегда кодируйте каждый кусочек информации о своих наблюдениях, используя текст. Например, если вы сохраняете данные в Excel и используете 
форму с цветным текстом или фоном ячейки, отформатированным для указания информации о наблюдении ("значения переменных, выделенных красным были обнаружены в эксперименте 1."), 
то эта информация не будет экспортироваться (и будет потеряна!), когда данные экспортируются в качестве исходного текста. Каждая кусочек данных должен быть закодированы как обычный текст, 
который можно экспортировать.  

### Список инструкций/скрипт

Возможно вы слышали это раньше, но [воспроизводимость является очень важным фактом в области вычислительных наук](http://www.sciencemag.org/content/334/6060/1226).
Этоозначает, что когда вы отправляете ваш документ, рецензенты и весь остальной мир должны быть способны в точности повторить анализ 
сырых данных на всем пути до конечного результата.Если вы пытаетесь быть более эффективным, то вы вероятно сделаете некоторое обощение/шаги по анализу данных, 
до того как данные будут считаться обработанными.

Идеальная вещь для вас создать при выполнении обобщения компьютерный скрипт (на`R`, `Python` или чем-нибудь еще), который будет принимать сырые данные на входе и 
выполнять обработку данных, которые вы потом отправите на выходе. Вы можете запустить скрипт пару раз и увидеть, дает ли код на выходе один и тот же результат.

Во многих случаях, человек, который собрал данные, имеет стимул обработать их для статистика, чтобы ускориь процесс сотрудничества. Они могут не знать как 
кодировать на языке скриптов. В этом случае, вы должны предоставить статистикам нечто, называемое [псевдокод](http://en.wikipedia.org/wiki/Pseudocode). Это 
должно выглядеть примерно так:

1. Шаг 1 - взять сырой файл, запустить версию 3.1.2 обобщающего программного обеспечения с параметрами a=1, b=2, c=3
1. Шаг 2 - запустить программное обеспечение отдельно для каждого примера
1. Шаг 3 - взять третью колонку в файле outputfile.out, сформированного для каждого примера и это будет соответсвующей строкой в наборе выходных данных.

Вы должны также включать информацию о опреационной системе (Mac/Windows/Linux)Ю которую вы использовали или на чем вы пробовали несколько раз и что 
подтвердило одни и теже результаты. В идеале вы будете запускать это с помощью студента/лаборанта, чтобы подтвердить, что они могут получать теже 
данные на выходе, что и вы.


Что вы должы ожидать от аналитика
====================

When you turn over a properly tidied data set it dramatically decreases the workload on the statistician. So hopefully
they will get back to you much sooner. But most careful statisticians will check your recipe, ask questions about
steps you performed, and try to confirm that they can obtain the same tidy data that you did with, at minimum, spot
checks.

You should then expect from the statistician:

1. An analysis script that performs each of the analyses (not just instructions)
1. The exact computer code they used to run the analysis
1. All output files/figures they generated. 

This is the information you will use in the supplement to establish reproducibility and precision of your results. Each
of the steps in the analysis should be clearly explained and you should ask questions when you don't understand
what the analyst did. It is the responsibility of both the statistician and the scientist to understand the statistical
analysis. You may not be able to perform the exact analyses without the statistician's code, but you should be able
to explain why the statistician performed each step to a labmate/your principal investigator. 


Contributors
====================

* [Jeff Leek](http://biostat.jhsph.edu/~jleek/) - Wrote the initial version.
* [L. Collado-Torres](http://bit.ly/LColladoTorres) - Fixed typos, added links.
* [Nick Reich](http://people.umass.edu/nick/) - Added tips on storing data as text.


